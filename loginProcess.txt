1. Clicking "Anmelden" on STiNE always re-directs to
https://cndsf.ad.uni-hamburg.de/IdentityServer/Account/Login?ReturnUrl=%2FIdentityServer%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DClassicWeb%26scope%3Dopenid%2520DSF%26response_mode%3Dquery%26response_type%3Dcode%26nonce%3DkQEKs7lCwN2CEXvCDeD1Zw%253D%253D%26redirect_uri%3Dhttps%253A%252F%252Fstine.uni-hamburg.de%252Fscripts%252Fmgrqispi.dll%253FAPPNAME%253DCampusNet%2526PRGNAME%253DLOGINCHECK%2526ARGUMENTS%253D-N000000000000001,ids_mode%2526ids_mode%253DY
https://cndsf.ad.uni-hamburg.de/IdentityServer/Account/Login?ReturnUrl=%2FIdentityServer%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DClassicWeb%26scope%3Dopenid%2520DSF%26response_mode%3Dquery%26response_type%3Dcode%26nonce%3DkQEKs7lCwN2CEXvCDeD1Zw%253D%253D%26redirect_uri%3Dhttps%253A%252F%252Fstine.uni-hamburg.de%252Fscripts%252Fmgrqispi.dll%253FAPPNAME%253DCampusNet%2526PRGNAME%253DLOGINCHECK%2526ARGUMENTS%253D-N000000000000001,ids_mode%2526ids_mode%253DY

2. When logging in following request is sent to https://cndsf.ad.uni-hamburg.de/IdentityServer/Account/Login?ReturnUrl=%2FIdentityServer%2Fconnect%2Fauthorize%2Fcallback%3Fclient_id%3DClassicWeb%26scope%3Dopenid%2520DSF%26response_mode%3Dquery%26response_type%3Dcode%26nonce%3DkQEKs7lCwN2CEXvCDeD1Zw%253D%253D%26redirect_uri%3Dhttps%253A%252F%252Fstine.uni-hamburg.de%252Fscripts%252Fmgrqispi.dll%253FAPPNAME%253DCampusNet%2526PRGNAME%253DLOGINCHECK%2526ARGUMENTS%253D-N000000000000001,ids_mode%2526ids_mode%253DY
POST
Antiforgery.Datenlotsen.Cookkie is included
Username
Password
RememberLogin: true
RequestVerificationToken: CfDJ8KhkoZI-s0xFkAhxYqDlnTtdt39OEXvC2Z9ITh_wBxtNRXgHC4CnBBF8C-0_pdVPEvuMghbCBKZRNKyhWqHnrLvV8_rscCKXDJZvL8fw7h0dyRAHAt1WEVB1otpkLsxtxnzXEajNEZfdR7l6i3fU6MY

Response Cookies
idsrv.session \text { t-roRzE7E3i1LdlGfnNKCQ }
idsrv CfDJ8KhkoZI-s0xFkAhxYqDlnTsWSnY2SpfLpMf7KzX0-I0gIkwZIN37QZWM4DtoNOKb4obEzvL137Nb8dPs4wTENKBji28gOl4ubV7C8rGg96rBu3JjYSuMwX9R1SjclYS6H8_QI-IaZPdPUdhH4S0Ff2-hf0J5ogX1cgee4z5Kg6puMBOT8Vbl_1I0yt_iLnBVncyK_7Lbt4qADFkcufTv1z46cJOodRfXoIdsnewSS9Ogym5kE_nK-s5h7NhomyNfoXbLvxNn96g0F9zR4bUG-CToMlqx0QW4aaym1xybNgCMsVEYejJq-cKYMVRtPUBrz7ozRZwAWd4u8JRpgrL5EzIW_waiP2XNfdWeyAXq4f42TjtCL8BCZAMIjgJbCH3eeW3uCqPNfWq6L2h-aMc0LIzrpxdLp1Nq4nXICEx30E8B5Imx0kPELGboOk7aA7WNUL_Ole0-iLkvGGhqOUxiu6wDQqg9IAu-S3PBQ4KFAKvfQ-L9j9SyLCfb7ZYq_vPyqdW7b9vo8Ne1a_QYPygIJcqhr6OCutnC8p0q4s8UHe39dhMgOgI0qeQkAzJxOuid7rW1g2fzsabtEF16fLveO3wlmXWbX9OXQDps2bBbofGKfzI78AqgyrSb7tr443P-f4a4CWI9OiKe5pngEJSCRVVoQL4A_B34dHAv1n_Ov-0EN0qpoOnuWSo6m1dZ7DsdlTvuihbyBiv6Z8dV_QPCgjfeGv-hD7WzzXq5f_mb3dk4DvrIrNrpmUf1b0XEOqBgQyr2tPuPMjLEJA4oEgTVMqQ5FPm7bCJ_GnN6lD9cbagfvUlL7ii6UqLUXVv7GvHvdWsfXzuQgKXfQyXnsq629Tu8Q4OW5xF1OcvPfWH56gVO9toaqoBPY_8vPFrY8-n51LqoKwVblAByq2VCApoCsPcoMdrQXetFxr5O3pQZfrykvgh1Lktm0Mqoe8yvobUgOQOkOgavm_C2LlWtERWZz2gnECObF4AgZLoâ€¦

as form data

3. Then a request is sent with the Antiforgery, idsrv, and idsrv.session cookie to https://stine.uni-hamburg.de/scripts/mgrqispi.dll?APPNAME=CampusNet&PRGNAME=LOGINCHECK&ARGUMENTS=-N000000000000001,ids_mode&ids_mode=Y&code=6aBOWNDRagIDr6jXrD0Rd5IN4ykodFmSm69Zkixklv0&scope=openid%20DSF&session_state=AxNsnI2JwdkQrYflHC0vzIA1jNWF0zMXQaVBGRzt0R8.fWUegKO7rZzezebB4G2PFg
a CNSC cookie is returned, this is the authentication token for STiNE 6DFC4605546BE2DC9C4E8FC27C297189